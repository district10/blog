---
title: GIS 理论与技术 -- 作业 2：GIS 研究综述
date: 2015-10-21
key-words:
tags:
    - homework
    - gis
    - overall
...

GIS 理论与技术 -- 作业 2：GIS 研究综述
======================================

> 这篇文章展示了如何用 bib 文件插入参考文献：
>
> * md 文件见 [post-0050-gis-overall.md](post-0050-gis-overall.md)
> * bib 文件见 [post-0050-gis-overall.bib](post-0050-gis-overall.bib)。

GIS 既是一项技术，也是一门学科。也有人说它是地理学的第三代语言[^gislang]，
也有人说它是 the science of problem solving[^sops]。

[^gislang]: “如果说地图是地理学的第二代语言，那么地理信息系统就是地理学的第三代语言。” ，陈述彭。
[^sops]: 出自 *Geographic Information and Science*（2014，Paul A. Longley，
         Michael F. Goodchild，David J. Maguire，David W. Rhind），p. 13。

1. 地理信息系统总述
-------------------

本节从一些基础概念引出地理信息系统，然后介绍其特征。

### 1.1 概念介绍

简述信息、数据、地理数据、地理信息、信息系统等概念，引出地理信息系统。[@Slocum2005]

信息

:   是向人们或机器提供关于现实世界新的事实的知识，是数据、消息中所包含的意义，
    它不随载体物理设备形式的改变而改变。信息具有客观性、实用性、传输性、共享性特征。

数据

:   数据是指某一目标定性、定量描述的原始资料，包括数字、文字、符号、图形、图像以及它们能转换成的数据等形式。
    数据是用以载荷信息的物理符号，数据本身并没有意义。信息与数据是不可分离的。

地理数据

:   表征地理圈或地理环境固有要素或物质的数量、质量、分布特征、联系和规律的数字、文字、图像和图形等的总称。

地理信息

:   有关地理实体的性质、特征和运动状态的表征和一切有用的知识，它是对地理数据的解释。

信息系统

:   具有数据采集、管理、分析和表达数据能力的系统，它能够为单一的或有组织的决策过程提供有用的信息。

    分为：

    * 事物处理系统（Transaction Process System，TPS）
    * 管理信息系统（Management Information System，MIS）
    * 决策支持系统（Decision Support System，DSS）
    * 人工智能和专家系统（Expert System，ES）

地理信息系统

:   地理信息系统（Geographical Information System，GIS）是一种决策支持系统，它具有信息系统的各种特点。
    地理信息系统与其他信息系统的主要区别在于其存储和处理的信息是经过地理编码的，
    地理位置及与该位置有关的地物属性信息成为信息检索的重要部分。在地理信息系统中，
    现实世界被表达成一系列的地理要素和地理现象，这些地理特征至少由空间位置参考信息和非位置信息两个组成部分。

![图 1. A wetland map of part of Erie County, Ohio, USA. The map has been made by classifying
  Landsat imagery at 30 m resolution. Brown = woods on hydric soil, dark blue = open water (excludes Lake Erie),
  green = shallow marsh, light blue = shrub/scrub wetland, blue-green = wet meadow, pink = farmed wetland.
  Source: Ohio Department of Natural Resources, www.dnr.state.oh.u][wetland]

### 1.2. 地理信息系统

地理信息系统具有以下三个方面的特征：

* 第一，具有采集、管理、分析和输出多种地理信息的能力，具有空间性和动态性；
* 第二，由计算机系统支持进行空间地理数据管理，并由计算机程序模拟常规的或专门的地理分析方法，
  作用于空间数据，产生有用信息，完成人类难以完成的任务；
* 第三，计算机系统的支持是地理信息系统的重要特征，因而使得地理信息系统能以
  快速、精确、综合地对复杂的地理系统进行空间定位和过程动态分析。

从类型上，地理信息系统可以分为：
1）专题地理信息系统（Thematic GIS），
2）区域信息系统（Regional GIS），
3）地理信息系统工具或地理信息系统外壳（GIS Tools）。

地理信息系统的构成随时代变化而不断扩展，曾经主要由四部分构成：
计算机硬件系统、计算机软件系统、地理数据（或空间数据）和系统管理操作人员。
后来逐步发展演变为 Network、People、Data、Software 和 Hardware，并以网络为中心[@Saltzer1985]，如图 2。

![图 2. 6 Parts of a GIS: Network, People, Data, Software, Hardware][6parts-of-gis]

地理信息系统的核心问题可归纳为五个方面的内容：位置、条件、变化趋势、模式和模型。

位置（Locations）

:   即在某个特定的位置有什么。

    1. 首先，必须定义某个物体或地区信息的具体位置，常用的定义方法有：
       通过各种交互手段确定位置，或者直接输入一个坐标；
    2. 其次，指定了目标或区域的位置后，可以获得预期的结果以及其所有或部分特性，
       例如当前地块所有者、地址、土地利用情况、估价等。

条件（Conditions）

:   即什么地方有满足某些条件的东西。

    1. 首先，可以用下列方式指定一组条件，如从预定义的可选项中进行选取；填写逻辑表达式；在终端上交互地填写表格。
    2. 其次，指定条件后，可以获得满足指定条件的所有对象的列表，如在屏幕上以高亮度显示满足指定条件的所有特征，
       例如，其所位于的土地类型为居民区、估价低于 200,000 美元、有四个卧室而且是木制的的房屋。

变化趋势（Trends）

:   该类问题需要综合现有数据，以识别已经发生了或正在发生变化的地理现象。

    1. 首先，确定趋势，当然趋势的确定并不能保证每次都正确，一旦掌握了一个特定的数据集，
       要确定趋势可能要依赖假设条件、个人推测、观测现象或证据报道等。
    2. 其次，针对该趋势，可通过对数据的分析，对该趋势加以确认或否定。
       地理信息系统可使用户快速获得定量数据以及说明该趋势的附图等。
       例如，通过 GIS，可以识别该趋势的特性：有多少柑桔地块转作它用？现在作为何用？
       某一区域中有多少发生了这种变化？这种变化可回溯多少年？哪个时间段能最好反映该趋势？
       1 年、5 年还是 10 年？变化率是增加了还是减少了？

模式（Patterns）

:   该类问题是分析与已经发生或正在发生事件有关的因素。地理信息系统将现有数据组合在一起，
    能更好地说明正在发生什么，找出发生事件与哪些数据有关。

    1. 首先，确定模式，模式的确定通常需要长期的观察、熟悉现有数据、了解数据间的潜在关系。
    2. 其次，模式确定后，可获得一份报告，说明该事件发生在何时何地、显示事件发生的系列图件。
       例如，机动车辆事故常常符合特定模式，该模式（即事故）发生在何处？发生地点与时间有关吗？
       是不是在某种特定的交叉处？在这些交叉处又具有什么条件？

模型（Models）

:   该类问题的解决需要建立新的数据关系以产生解决方案。

    1. 首先，建立模型，如选择标准、检验方法等。
    2. 其次，建立了一个或多个模型后，能产生满足特定的所有特征的列表，并着重显示被选择特征的地图，
       而且提供一个有关所选择的特征详细描述的报表。例如要兴建一个儿童书店，
       用来选址的评价指标可能包括 10、15、20 分钟可到达的空间区域。
       附近居住的 10 岁或 10 岁以下的儿童的人数、附近家庭的收入情况、周围潜在竞争的情况。

### 1.3. 地理信息系统的方方面面

作为 a science of problem solving，地理信息系统的一般操作流程是：

1. 数据采集、监测与编辑
2. 数据处理
3. 数据存储与组织
4. 空间查询与分析
5. 图形与交互显示

其基本研究内容如图 3。

![图 3. GIS 的研究内容][gis-research]

地理信息系统基本理论研究包括：1）研究地理信息系统的概念、定义和内涵；2）地理信息系统的信息论研究；
3）建立地理信息系统的理论体系；4）研究地理信息系统的构成、功能、特点和任务；
5）总结地理信息系统的发展历史，探讨地理信息系统发展方向等理论问题。

地理信息系统技术系统设计包括：1）地理信息系统硬件设计与配置；2）地理空间数据结构及表示；
3）输入与输出系统；4）空间数据库管理系统[@Rybinski1987]；5）用户界面与用户工具设计；
6）地理信息系统工具软件研制；7）微机地理信息系统的开发；8）网络地理信息系统的研制等[@Grolinger2013]。

地理信息系统应用方法研究：1）包括应用系统设计和实现方法；2）数据采集与校验；
3）空间分析函数与专题分析模型；4）地理信息系统与遥感技术结合方法；5）地学专家系统研究等。

总之，地理信息系统的内容主要包括：1）有关的计算机软/硬件；2）空间数据的获取及计算机输入；
3）空间数据模型及数字表达；4）数据的数据库存储及处理；5）数据的共享、分析与应用；
6）数据的显示与视觉化；7）地理信息系统的网络化等等。

GIS 的科学基础是：

* 地球系统科学（Earth System Science）理论（系统论、控制论），
* 地球信息科学理论（Geo-Informatics，Geo Information Science）（信息论），
* 地理信息科学（Geographic Information Science）（信息论，交叉学科、综合学科），
* 地球空间信息科学（Geomatics，Geo Spatial Information Science）（信息论）[@Miller1942]。

主要的理论有：

1. 地理系统（某一个特定时间和特定空间的，由两个以上相互区
   别又相互联系、相互制约的地理要素或过程所组成的，并具有特
   定的功能和行为，与外界环境相互作用，并能自动调节和具有自
   组织功能的整体。）
2. 分形理论
3. 人地系统理论（可持续发展理论现成主流）
4. 整体性与分异理论
5. 区位理论（研究区位特征）
6. 地理信息理论（熵、流、场）
7. 地理实体电磁波能量信息理论
8. 地理信息关联性理论（普遍的相互联系、依存、制约）
9. 地理空间认知理论（四个过程：感知 -> 表象 -> 记忆 -> 思维）
10. 地理学定律
    + 地理学第一定律：空间相关性
    + 地理学第二定律: 空间异质性
    + 地理学第三定律: Everything has it’s own attribute
11. 空间关系理论（空间关系：顺序、度量、拓扑）
12. 地理空间认知理论（理解地理空间，进行地理分析和决策）
13. 地理空间推理理论
14. 空间数据不确定性分析理论（影响 GIS 产品的质量）

### 1.4. 地理信息系统发展简史

（略）

### 1.5. 地理信息系统发展展望

（略）

### 1.6. 小结

地理信息系统（GIS）是 Geographic Information System，也是 Geographic Information Science，
还是 Geographic Information Service，在信息时代还可以是 Geographic Information Service + Internet = New Service / Web Service。
地理信息系统是系统，是科学，还能服务大众，在互联网时代应用广泛、贡献卓越。

2. 空间认知
-----------

空间认知（Spatial cognition）是一门有关从空间环境获取、组织、利用和再现信息的科学。

人类的发展和其空间认知能力有极大联系，可以说强大的空间认知能力成就了人类。
研究空间认知，揭示空间认知的原理，有助于提高人类的空间认知能力，也是提高计算机认知水平的必然要求。

大量的学科与空间认知理论直接或间接地紧密相连，其中心理学和脑科学与空间认知联系最为紧密。
空间认知研究在沟通心理学和脑神经科学上，起着至关重要的作用。两个学科的研究人员通过
运用空间认知理论研究人脑的心理活动和脑神经工作方式的联系，取得了可喜的进展；
另一方面，通过不断的检验这些理论，用事实和实例证实或证伪一些空间认知理论，补充完善了空间认知理论的体系框架。

空间认知的终极目标是能够完全区别并了解空间内所有物体的各自运动状态和相互关系。


### 2.1. 认知相关

[^ref2]:  Maurizio Tirassa, Antonella Carassa, Giuliano Geminiani. *A Theoretical Framework for the Study of Spatial Cognition*[J].
          Spatial Cognition: Foundations and applications, Selected papers from Mind III,
          Annual Conference of the Cognitive Science Society of Ireland, 1998.

略去地理学中空间分析的历史，空间分析的地理学研究包括 5 个方面，信息的获取；空间信息的结构和处理方法；
空间的转移和变换；空间信息的信息表达方式，以及空间整体和局部的相似与不同。

空间认知的前提是空间，其中包含细碎的可能，空间认知的任务就是理解分析它。
理解和分析的前提是适应和交互。主体适应环境就是和客体不断交互。

认知即取决于脑（认知主体）的结构，还和环境的耦合度有关。高度耦合的环境，是认知的难点。
高耦合的客体大致可以分为两类：Reflex-based architectures，以及 Affordance-based architectures。
打个比喻，前者像一个漫反射的面，不管光从哪个方向照入，反射光的都像是环境光，你无法判断光的来源，
因为它是无法认知的。相对地，Affordance-based architectures 的客体存在与外界的交互，是可认知的事物。

总言之，从这个意义上，认知就是对环境的解耦，低耦合的物体有利于认知。[@AllemanNathanF.Holly2011]

从另一个角度看，认知也是一个对耦合物体解耦的过程，就是把耦合的世界不断离息的过程。
Decoupled architectures 分为三大部分： Deictic archituctures, base-level representational architecture
和 Metarepresentational archituctures。三者的关系层层深入，处于认知的终级阶段 Metarepresentational archituctures，
顾名思义，就是对物体的最本质抽象，认知到了物体的“元”[^meta]。

[^meta]: “元”，“元数据”的“元”[@NationalInformationStandardsOrganization2004]。

小结，认知是通过与外界交互，不断对混沌的环境解耦，了解周围事物本质的过程。
认知的终极目标，就是提取事物的本质（“元”），洞悉事物呈现/存在的规则。

### 2.2. 空间的呈现和表达

空间认知，是对事物和环境的认知，需要对空间进行度量。度量的方式可以是空间参考系，
用统一绝对（哪怕是局部绝对）的坐标来度量。还可以通过相对关系来定义空间。如图 4。

![图 4. A is a schematic illustration of a cognitive vector space, B illustrates
  a selfreference system consisting of a representation of the front-back/right-left
  axes of the body, and C illustrates superposition of a self-reference system
  on the cognitive vector space. The metric coordinates of the objcets represented
  in the vector space are computed by the selfreference system.][spatial-ref]

空间度量并不总能区分事物，占据统一空间的事物可能是不同的，如果要区分他们，
我们的认知体系还需要引入别的参考，还需要讨论物与物之间可分性的问题。
在计算机中，事物可以通过自参考，来区分自己和环境，就像 Python 里特殊的 self 参数做的那样。
这样的认知假设，可以解决“真假美猴王”的问题。

至于如何量化，我看到的有 Architecture of CHAMELEON， 将空间看成未知，通过多种手段探知，再综合，即：

![图 5. Architecture of CHAMELEON][arch-of-cham]

它将认知过程描述成：

```plain
PROCESSING(6):
LASER:
(1) wakes up when it detects registering of F-int
(2) reads F-int and sees it’s from DOMAIN-MODEL
(3) produces F-out (pruning + registering)
(4) places and registers F-out on blackboard:
```

方法多种多样，还有许多可以参考[^ref3] [^ref4] [^ref5] [^ref6]，这里不再展开。

[^ref3]: John Kelleher, Tom Doris, Qamir Hussain. *SONAS: Multimodal,
         Multi-User Interaction with a Modelled Environment*[J].
         Spatial Cognition: Foundations and applications, Selected papers from Mind III,
         Annual Conference of the Cognitive Science Society of Ireland, 1998.
[^ref4]: Mike Eisenberg, Ann Eisenberg. *Designing Real-Time Software Advisors for 3D Spatial Operations*[J].
         Spatial Cognition: Foundations and applications, Selected papers from Mind III,
         Annual Conference of the Cognitive Science Society of Ireland, 1998.
[^ref5]: Robert K. Lindsay. *Using Spatial Semantics to Discover and Verify Diagrammatic Demonstrations
         of Geometric Propositions*[J]. Spatial Cognition: Foundations and applications , Selected papers from Mind III,
         Annual Conference of the Cognitive Science Society of Ireland, 1998.
[^ref6]: Andrew U. Frank, Martin Raubal. *Formal Specifications of Image Schemata for Interoperability
         in Geographic Information Systems*[J]. Spatial Cognition: Foundations and applications ,
         Selected papers from Mind III, Annual Conference of the Cognitive Science Society of Ireland, 1998.

其中的一个用 Lisp（计算机历史上第二个高级语言）的方言 MacScheme 写成的游戏 HyperGami，是最早出现的和空间感知相关的游戏。

![图 6. The HyperGami screen in the course of a sample project][hyper-gami]

上述的空间表达方式中很大一部分是基于语义的空间信息表达，就像用 “P 271” 表达一个点。又或者用

```plain
a (R;S) c = aRb and bSc
for example: North;NorthEast = {North or NorthEast}
meet;inside = {inside, covered, overlap}
```

来表达空间的包含叠置关系。这符合人的思维方式，也是计算机的思维方式
（当然，计算机就是用人类的思维方式设计的），便于人类理解与计算机实现。

### 2.3. 语言与空间表达

这一部分讨论空间认知与表达时语言不精确带来的麻烦。

通常我们用介词来指示空间位置，如 "Put the book on the table"。但如果一个介词无法无歧义地传达含义时，
我们就需要加上别的限定词，如这句 "Stack the book on the pile of books"，为了明确表达空间指代，我们需要强调 "the pile of"。

通常言，限定越多，空间表达就越具体，歧义越少，模糊性越低。但语言有它的极限，
除了表达不当造成的歧义，其自身局限性也给空间指示带来了麻烦。举一个不相关的例子，
自由软件，在中文里就没什么问题，但其英文： "free software"，就会给人造成困惑，
因为 free 在英文中既是自由，还有免费、不要钱的意思。所以自由软件运动核心人物 Richard Matthew Stallman
在提及自己的自由软件时总要强调说那不是 "free  beer" 的 "free"，
是 "free speech" 的 "free"，是 "free as in freedom"。同样地，中文也有其局限性，这里不再展开。

解决这个问题的方法是创造一种是符号化的歧义更少的语言来表达空间关系，引入充分的空间谓词，而不是用自然语言。

### 2.4. 记忆、意识和空间感

这一部分通过心理学实验讨论了人脑的记忆、意识和空间感知。

Johnson-Laird 在 1983 年提出了三个猜想[^ref8]：

1. 高耦合的空间理解起来更难；
2. 人们通过逻辑推理和语言解释在心里重建空间模型；
3. 语言是人认知空间的重要工具。

是人类对记忆、意识和空间感的第一次思考[^3guess]。

[^3guess]: 论文 *Given-New Versus New-Given?: An analysis of reading times for spatial descriptions*
           通过研究人类的空间描述相关文字的阅读习惯，用实验验证了这三个猜想。

![图 7. Diagram of relationship between phonological loop/visual cache components and conscious imagery
  during mental synthesis (from Pearson, Logie & Gilhooly, 1999)][phonological]

[^ref8]: Byrne, R. M. J., Johnson-Laird, P. N.. *Spatial reasoning.
         Journal of Memory and Language*, 28, 564–575, 1989.

### 2.5. 小结

研究人类的空间认知原理可以启发计算机认知方式，对计算机智能化有着重要意义。
揭示空间认知的奥秘，就有了打开崭新未来世界之门的钥匙。
未来空间认知研究的主方向依旧还是对人脑认知机理的揭示，因为人脑就是人类最大的一笔财富。

3. 空间分析
-----------

### 3.1. 简介

空间分析是基于地理对象的位置和形态特征的空间数据分析技术，其目的在于提取和传输空间信息（郭仁忠，1997），
是对数据的空间信息、属性信息或者二者共同信息的统计描述或说明（Goodchild，1987），
是基于地理对象布局的地理数据分析技术（Hainning，1990），是对于地理空间现象的定量研究，
其常规能力是操纵空间数据使之成为不同的形式，并且提取其潜在的信息（Baily，1995；Openshaw，1997） ，
是从一个或多个空间数据图层获取信息的过程。空间分析是集空间数据分析和空间模拟于一体的技术，
通过地理计算和空间表达挖掘潜在空间信息，以解决实际问题（刘湘南等）。

空间分析主要包括三方面的内容：

1. 空间分析理论 : 介绍空间分析的一些理论问题，
   如空间关系理论、空间认知理论、空间推理理论,以及其它理论。
2. 空间分析方法 : 介绍空间分析的各种具体方法,如栅格数据的空间分析方法、
   矢量数据的空间分析方法、三维数据的空间分析方法、空间数据统计分析方法等。
3. 空间分析建模 : 介绍空间分析的过程建模、应用建模。

空间分析研究的对象是具有空间位置、分布、形态、空间关系 （ 距离、方位、拓扑、相关场 )的空间目标。
其研究目标是建立有效的空间数据模型来表达地理实体的时空特性，发展面向应用的时空分析模拟方法，
以数字方式动态地、全局地描述地理实体和地理现象的空间分布关系，从而反映地理实体的内在规律和变化趋势，
GIS 空间分析是对 GIS 空间数据的一种增值操作。

### 3.2. 空间分析的基本理论

#### 3.2.1. 拓扑关系、度量关系、顺序关系

空间关系是 GIS 的重要理论问题之一，在空间数据建模、空间查询、空间分析、空间推理、制图综合、地图理解等过程中都起着重要作用。
空间关系可以由空间现象的几何特性引起，如距离、方位、连通性、相似性等，也可以由空间现象的几何特性和非几何特性共同引起，
如空间分布现象的统计相关、空间自相关、空间相互作用、空间依赖等， 还可以完全由空间现象的非几何属性导出空间关系。

拓扑空间

:   关系是指拓扑变换下的拓扑不变量，如空间目标的相邻和连通关系，橡皮几何学。

方向关系

:   最基本的顺序关系，又称为方位关系、延伸关系，是指源目标相对于参考目标的顺序关系。

度量关系

:   利用距离公式量化两个目标间的空间关系。

从约束强度上比较，度量关系大于顺序关系，顺序关系大于拓扑关系。

#### 3.2.2. 地理空间推理

空间推理是指利用空间理论和人工智能技术对空间对象进行建模、描述和表示，并据此
对空间对象间的空间关系进行定性或定量分析和处理。地理空间推理主要研究地理事物在
地理空间中位置的表达和相关推理。

地理空间推理特点有：

* 以空间和存在于空间中的空间对象为研究对象。
* 推理过程中运用人工智能技术和方法。
* 处理的是一个或几个推理的问题。
* 基于空间和存在于空间中的空间对象已经被建模的前提下，不能在没有模型的情况下讨论空间推理。
* 必须能够给出关于空间和存在于空间中的空间对象的定性或定量的推理结果。
* 必须能够描述空间行为。
* 空间推理模型把问题分解为几个组成部分时，必须能够描述这些组成部分的相互作用。
* 空间推理过程中，可能用到空间谓词，空间中确定的点使某些空间谓词为真，而使另一些空间谓词为假。
* 应该能够处理带有模糊性和不确定性的空间信息。
* 应该能够添加和处理时间因素，即成为时空推理。
* 应该具有空间自然语言理解能力。

#### 3.2.3. 空间数据的不确定性分析

不确定性是指被测量对象知识缺乏的程度，通常表现为随机性和模糊性。

### 3.3. 栅格数据空间分析

地理空间认知模型主要有三个：

* 场模型：强调空间要素的连续性
* 基于对象的模型：强调空间要素的离散性
* 网络模型：强调空间要素的交互

在空间信息系统中，场模型一般指的是栅格模型，其主要特点就是用二维划分覆盖整个连续空间。
栅格数据由一系列的规则格网单元组成，用于表达专题、光谱及图像等数据，
可以在一定空间范围内模拟连续变化的地理现象或图片数据。

#### 3.3.1. 栅格数据的聚类、聚合分析

* 将栅格数据系统经某种变换而得到具有新含义的栅格数据系统的数据处理过程。
* 聚类分析是根据设定的条件对原有数据系统进行有选择的信息提取而建立新的栅格数据系统的。
* 聚合分析是指根据空间分辨率和分类表，进行数据类型的合并或转换以实现空间地域的兼并。

#### 3.3.2. 栅格数据的信息复合分析

* 信息复合模型（Overlay）包括两类：简单的视觉信息复合和较为复杂的叠加分类模型。
* 视觉信息复合
    + 面状图、线状图和点状图之间的复合；
    + 面状图区域边界之间或一个面状图与其它专题区域边界之间的复合；
    + 遥感影像与专题地图的复合；
    + 专题地图与数字高程模型复合显示立体专题图；
    + 遥感影像与 DEM 复合生成真实三维地物景观；
* 较为复杂的叠加分类模型：数学运算复合 = 算术运算 + 函数运算。

#### 3.3.3. 栅格数据的追踪分析

（略）

#### 3.3.4. 栅格数据的窗口分析

可以表示为：

```plain
窗口分析 := [ 中心点 + 分析窗口大小与类型(矩、圆、环、扇)
　　　　  +   运算方式(统计运算，测度运算，函数运算) ]
```

#### 3.3.5. 栅格数据的量算分析

（略）

### 3.4. 矢量数据空间分析

矢量数据对有确定位置与形状的离散要素是理想的表示方法。

矢量数据空间分析一般不存在模式化的分析处理方法，表现为处理方法的多样性和复杂性。
对矢量数据可进行包含分析、缓冲区分析、叠置分析、网络分析等常规操作。
以流行的地理信息系统软件 ArcGIS 为例，其矢量数据空间分析工具就包含了：

* 缓冲区分析
    + 普通缓冲区
    + 属性权值缓冲区
    + 分级缓冲区
* 叠置分析
    + 图层擦除
    + 识别叠加
    + 交集操作
    + 对称区别
    + 图层合并
    + 修正更新
* 网络分析
    + 传输网络分析（Network Analyst）
        - 计算点与点之间的最佳距离
        - 进行多点的物流派送
        - 寻找最近的一个或者多个设施点
        - 确定一个或者多个设施点的服务区
        - 绘制“起点 - 终点”的距离矩阵
    + 效用网络分析（Utility Network Analyst）
        - 效用网络是有向网络，网络中流动的对象必须按照在网络中定义好的规则前进，
          运行路径是事先定义好的
        - 在 ArcGIS 中，效用网络是通过几何网络来模拟的。
        - 效用网络常用于水、电、气等管网的连通性分析：
            + 寻找连通的或不连通的管线；
            + 进行上游或下游追踪；
            + 寻找环路；
            + 寻找通路或进行爆管分析等。

### 3.5. 三维数据空间分析

主要包括 DEM、TIN、面积体积量算方法、坡度坡向计算方法、缓冲区分析、水文分析、可视性分析。

三维地形模型

:   高度变化有可能引起:

    #. 气候变化
    #. 土壤、植被、地质变化
    #. 地物变化
    #. 其它

数字地面模型 Digital Terrain Model, DTM

:   #. DTM 是指描述地球表面形态多种信息空间分布的有序数值阵列
    #. 从数学的角度,可用如下二维函数系列取值的有序集合表示数字地面模型 :
        i. $K_p = f_k(up,vp) (k=1..m; p = 1, 2, ...n)\,$
        #. $K_p$: 第 p 号地面点 ( 单一点或某点及其微小邻域所划定的一个地表面元 ) 上的第 K 类地面特性信息的值;
        #. (up, vp): 第 p 号地面点的二维坐标 ;
        #. m(m 大于等于 1): 地面特性信息类型的数目;
        #. n: 地面点的个数。
        #. ![Digital Terrian Model][sa-digital-terrian-model]

数字高程模型

:   DEM 是 DTM 的一个特例或者子集, 是 DTM 中最基本的部分,是对地球表面地形地貌的一种离散的数学表达。

    DEM 的具体应用

    #. 国家地理信息的基础数据: DEM 是国家空间数据基础设施 NSDI 的框架数据组成部分,是“ 4D 产品”之一。
    #. 土木工程、景观建筑与矿山工程的规划与设计;
    #. 军事目的 ( 军事模拟等 ) 的地表三维显示;
    #. 景观设计与城市规划;
    #. 水流路径分析、可视性分析;
    #. 交通路线的规划与大坝的选址;
    #. 不同地表的统计分析与比较;
    #. 生成坡度图、坡向图、剖面图,辅助地貌分析,估计侵蚀和径流等;
    #. 作为背景数据叠加各种专题信息,如土壤、土地利用及植被覆盖数据等,便于显示与分析。
    #. ![DEM][sa-dem-present]

    DEM 的表示方法

    #. 数学方法
        * 整体拟合: 将区域中所有高程点的数据用傅里叶高次多项式、随机布朗运动函数等统一拟合高程曲面。
        * 局部拟合: 把地面分成若干块,每一块用一种数学函数,如傅立叶级数高次多项式、随机布朗运动函数等,以连续的三维函数高平滑度地表示复杂曲面。
    #. 图形法
        * 线模式: 利用离散的地形特征模型表示地形起伏。如:等高线、山脊线
        * 点模式: 用离散采样数据点建立 DEM ,是最常用的生成 DEM 的方法之一
            + 点数据的采样方式:规则格网模式 (Grid)(正方形、矩形、三角形格网)、不规则模式 (TIN) 、根据山峰、洼坑等地形特征点有针对性地采样
            + 规则格网模型
                - 格网栅格的观点——格网单元的数值是其中所有点的高程值,即格网单元对应的地面面积内高程是均一的高度,这种数字高程模型是一个不连续的函数。
                - 点栅格观点——该网格单元的数值是网格中心点的高程或该网格单元的平均高程值,这样需要用一种插值方法来计算每个点的高程。
                - 优点:
                    * 结构简单、易于计算机处理,特别是栅格数据结构的地理信息系统
                    * 可以很容易地计算等高线、坡度、坡向、山坡阴影和自动提取流域地形
                - 缺点:
                    * 地形简单的地区存在大量冗余数据
                    * 地形起伏差别大的地区无法适用
                    * 对某些特殊计算 ( 如视线计算 ) 的格网轴线方向被夸大
                    * 如栅格过于粗略,则不能精确表示地形的关键特征,如山峰、坑洼、山脊、山谷等
        * 不规则三角网( TIN )
            + 优点:
                - 可根据地形的复杂程度确定采样点的密度和位置,能充分表示地形特征点和线,减少了地形较平坦地区的数据冗余。
                - 在显示速度及表示精度方面优于规则格网
                - TIN 是一种变精度表示方法:平坦地区数据点较少,地形起伏较大的地区数据点密度较大。这种机制使得 TIN 数据可用较小的数据量实现较高的表达精度。
            + TIN 方法的特点 ( 与 Grid 相比 ) :
                - 从等高线数据中选取重要的点构成 TIN ,并生成规则格网,在两者数据量相同的情况下, TIN 数据具有最小的中误差 RMS
                - 与数字正射影像 (DOM) 的叠加方面,基于 TIN 的地形图与影像的吻合程度比规则格网的地形图好;
                - 当采样数据点的数量减少时,规则格网模型的质量比 TIN 模型降低的速度快,但随着采样点或数据密度的增加,两者的差别会越来越小。
                - 从数据结构占用的数据量来看,在顶点个数相同的情况下, TIN 的数据量要比规则格网的大 ( 约 3~10 倍 ) 。

            + ![TIN Contour][sa-grid-tin-contour]

    DEM 在地图制图学与地学分析中的应用

    #. 绘制晕渲图
        * 晕渲图:采用光线照射使地表产生反射的地面表示方法,用于表现地貌地势。
        * 用 DEM 数据为信息源,以地面光照通量为依据,计算栅格输出的灰度值,由此得到晕渲图的立体效果,逼真程度很好。
        * 生成地面晕渲图的计算方法:
            + 首先根据 DEM 数据计算坡度和坡向;
            + 将坡向数据与光源方向比较:
            + 面向光源的斜坡得到浅色调灰度值;
            + 反方向得到深色调灰度值;
            + 两者之间得到中间灰值,中间灰值由坡度进一步确定。
    #. 绘制透视立体图
        * 立体图可以生动逼真地描述制图对象在平面和空间上分布的形态特征和构造关系。
        * 分析立体图,可以了解地理模型表面的平缓起伏,可以分析各个断面的状况。
        * 可以了解研究区域的轮廓形态、变化规律以及内部结构。
        * 制作透视立体图的基本流程
            + 理论基础是透视原理
            + 视点、视角不同,可以绘制方位、距离各异,形态各不相同的透视图,并制作动画
            + 四个参数:
                - 观察方位:观察者对地面的方向;
                - 观察角度:观察者所在高度与地平面的夹角;
                - 观察距离:观察者与地表的距离;
                - 竖向比例尺:垂直比例尺与水平比例尺的比率。

    ![晕渲图][sa-contour-shade]

    ![晕渲图][sa-contour-shade2]

三维可视化

:   三维可视化是三维 GIS 的基本功能。在进行三维分析时,数据的输入和对象的选择都涉及到三维对象的可视化。

    三维可视化是运用计算机图形学和图像处理技术,将三维空间分布的复杂对象 ( 如地形、模型等 ) 或过程转换为图形或图像在屏幕上显示并进行交互处理的技术和方法。

    观察坐标系中的三维裁剪:

    #. 人眼的观察范围是有一定角度和距离范围。在计算机实现三维可视化的时候,也有一定的观察范围,可用视景体 (Frustum) 来表示这个范围。
    #. 视景体 (Frustum) :由远、近、左、右、上、下 6 个平面确定。包括:
        * 平行投影视景体
        * 透视投影视景体
    #. 在三维图形显示过程中,将位于视景体范围外的物体裁剪掉而不显示。
        * 通过判断对象与视景体中的 6 个裁剪面的关系可以确定对象是否位于视景体内部。
        * 用户还可以根据需要增加一个附加裁剪面,去掉与场景无关的目标。

    ![][sa-3d-display]

    ![][sa-projection]

    #. 视口变换
        * Dim
            * 视口变换是指经过坐标变换、几何裁剪、投影变换后的物体显示到视口区域。
            * 视口变换类似指定区域的缩放操作;
            * 视口的长宽比例应与视景体一致,否则会使视口内的投影图像发生变形。
            * 当视角增大,投影平面的面积增大,视口面积与投影平面面积的比值变小,但由于物体的投影尺寸不变,所以实际显示的物体变小。反之,视角变小时,显示物体变大。
        * cat
            * 视图(视点)变换:把相机放在三角架上,并对准场景;
            * 模型变换:对场景进行安排,使物体在照片中位于你所希望的位置;
            * 投影变换:选择相机的镜头,调整放大倍数;
            * 视口变换:确定照片的大小。
    #. 常用的开发包: OpenGL、DirectX、QD3D、VTK、Java3D等, 用户可以利用这些开发包提供的接口实现三维显示中的各种功能。

    三维空间查询

    #. 三维数据的空间查询是三维 GIS 的基本功能之一, 是其它三维空间分析的基础。
    #. 三维空间查询的方式包括:
        * 基于属性数据的三维查询;
        * 基于图形数据的三维查询;
        * 图形属性的混合三维查询;
        * 模糊三维查询等。
    #. 三维坐标查询
        * 在获取三维坐标的过程中,由于屏幕上的三维模型的像点与三维模型的大地坐标不是一一对应的,必须把鼠标捕捉到的二维屏幕坐标转换为三维的大地坐标,这实际上是透视投影的逆过程。(屏幕二维点到三维坐标点的转换)
        * 高程查询: 对 TIN 数据,用内插的方法求出任意一点的高程。
            + 一般使用线性内插。
            + 内插过程包括格网点定位和高程内插两个过程。
                - 格网点定位
                - 高程内插

三维空间特征量算

:   #. 表面积计算
        * 分块曲面拟合:
        * 全局拟合的曲面:
            + 三角形格网表面积
                - 海伦公式
                    * $S = [ P( P − a)( P − b )( P − c )] 1 / 2$
                    * $P = \frac{a+b+c}{2}$
            + 正方形格网表面积:
                - 曲面拟合重积分法
                    * $S = \iint(1+f(x)^2 +f(x)^2)^{\frac{1}{2}} dxdy$
                    *  该式无法直接计算,常用的方法是近似计算。比较常用的方法是抛物线求积方法,亦称**辛卜生**方法。
                - 分解为三角形的方法
    #. 体积计算
        * 基本思想: 以基底面积 ( 三角形或正方形 ) 乘以格网点曲面高度的均值,区域总体积是这些基本格网体积之和。
        * 基于三角形格网的体积计算方法
            + $V = S_a( h_1 + h_2 + h_3 ) / 3$
            + ![][sa-volumn-tri]
        * 基于正方形格网的体积计算方法
            + $V = SA( h_1 + h_2 + h_3 + h_4 ) / 4$

常用的三维数据空间分析

:   #. 坡度和坡向计算
        * 坡度:某点在曲面上的法线方向与垂直方向的夹角,是地面特定点高度变化比率的度量。
        * 坡向:法线的正方向在平面上的投影与正北方向的夹角,即法方向水平投影向量的方位角。取值范围从零方向 ( 正北方向 ) 顺时针到 360 度。
        * 坡度和坡向计算
            + 基于规则格网 DEM 的坡度坡向计算
                - 设标准矢量为 (nx, ny, nz) ,则该格网单元的坡度 S 为: S = sqrt(nx+ny)/nz, 坡向 D 为: D = arctan(nx/ny)
                - 在实际计算时,通常是用 3×3 的移动窗口来计算中心单元的坡度和坡向
                - 计算时考虑邻接单元的影响有不同方式,常用的方法:
                    * Ritter 算法
                        + 只考虑直接与中心点单元相邻的 4 个单元,图中中心点 e
                        + 坡度 $S_e = (e_1−e_3)^2+\frac{(e_4−e_2)^2}{2d}$
                        + 坡向 $De = \arctan[(e4−e2)/(e1−e3)]+90°]$
                    * Horn 算法
                        + 考虑与中心单元相邻的 8 个相邻单元,直接邻接单元 (e2, e4, e5, e7) 的权值为 2 ,其它 4 个单元 (e1, e3, e6, e8) 的权值为 1
                        + ![][sa-horn-s]
                        + ![][sa-horn-d]
            + 基于不规则三角网 (TIN) 的坡度坡向计算
                - ![][sa-irregular-sd]
            + 基于等高线的坡度坡向计算
                - 等高线计长法
                    * 等高线计长法求出的是一个区域内坡度的均值,前提是量测区域内的等高距相等。
                    * 对于测区较大或等高距不等的情况计算出坡度有较大误差。
                - 统计学计算方法
                    * 是等高线计长方法的变通方法,用于测区较大或等高距不等的情况。其基本逻辑:地形坡度越大等高线越密、坡度越小等高线越稀。
                    * 优点：可操作性强，不受数据量的限制，能处理海量数据。
    #. 剖面分析
        * 以数字地形模型( DEM )为基础构造某一个方向的剖面,以线代面,概括研究区域的地势、地质和水文特征;
        * 可在地形剖面上叠加表示其它地理变量,可以作为提供土地侵蚀速度研究、农业生产布局的立体背景分析、土地利用规划, 以及工程决策
        * 基础: 地形剖面线 (地形剖面线根据所选剖面与数字地形图上地形表面的交点反应地形的起伏情况。)
        * 生成方法:
            + 基于规则格网 (Grid) 的方法
                - 确定剖面线的起止点。由坐标确定,或用鼠标在三维场景中选择决定;
                - 计算剖面线与经过网格的所有交点,内插出各交点的坐标和高程,将交点按离起始点的距离排序;
                - 顺序连接相邻交点,得到剖面线;
                - 选择一定的垂直比例尺和水平比例尺,以离起始点的距离为横坐标,以各点的高程值为纵坐标绘制剖面图。
            + 基于不规则三角网 (TIN) 的方法
                - 用剖面所在的直线与 TIN 中的三角面的交点得到剖面线。
                - 可先利用 TIN 中各三角形构建的拓扑关系快速找到与剖面线相交的三角面,再进行交点的计算,这样可以提高运算速度。
                - 最后,以距离起始点的距离为横坐标,以各点的高程值为纵坐标绘制剖面图。
    #. 谷脊特征分析
        * 是地形分析的重要内容, 在地学中的水文分析中有重要应用。如地表径流分析首先要找出该区域的谷脊点。
        * 谷: 地势中相对最低点的集合
        * 脊: 是地势相对最高点的集合
        * 基于栅格 DEM 数据判断谷点和脊点
            + ![][sa-low-high]
            + $VR(i,j)= -1$ &rarr; 谷点, $VR(i,j) = +1$ &rarr; 脊点; 该方法只能提供概略结果
            + 对谷脊特征作精确分析
                - 由曲面拟合方程建立地表单元的曲面方程;
                - 确定曲面上各个插值点的极小值和极大值;
                - 当插值点在两个相互垂直的方向上分别为极大值或极小值时,确定出谷点或脊点。
    #. 水文分析
        * 数据基础: 无洼地的 DEM
        * 关键步骤: 流向分析
        * 水文分析使用DEM数据派生其它水文特征: 提取河流网络、自动划分流域。这些是描述某一地区水文特征的重要因素
        * 无洼地 DEM 的生成
            + ![][sa-filled-sink]
            + DEM 数据中存在误差;
            + 存在一些真实的低洼地形,如喀斯特地貌
            + 在进行水流方向计算时,由于凹陷区域的存在,往往得到不合理的甚至错误的水流方向
        * 流向分析
            + 根据中心格网与邻域格网的最大距离权落差确定。
            + 距离权落差:中心栅格与邻域栅格的高程差除以两栅格间的距离。
            + 栅格间的距离与方向有关
                - ![][sa-grid-encoding]
                - 方向数为 1,4,16,64 ,距离为栅格单元边长的2 倍
                - 方向数为 2,8,32,128 ,距离为栅格单元的边长
        * 汇流累积矩阵的计算
            + 汇流累积数值矩阵:用矩阵形式表示区域地形每点的流水累积量。
            + 基本思想:
                - 以规则格网表示的数字地面高程模型的每点都有一个单位水量
                - 按照自然水流从高处往低处流的自然规律
                - 根据区域地形的水流方向数据计算每点处所流过的水量数值
                - 计算得到该区域的汇流累积量。
        * 水流长度:地面上一点沿水流方向到其流向起点 ( 或终点 ) 间的最大地面距离在水平面上的投影长度。
            + 水流长度的计算: 地面上一点沿水流方向到其流向起点 ( 或终点 ) 间的最大地面距离在水平面上的投影长度。
            + ![][sa-river-length]
        * 河网提取 (方法):
            + 主要采用地表径流漫流模型
            + 河网的生成基于流水累积量。
            + 设定阈值,思想是根据所设定的阈值对整个区域进行判断,
            + 其中汇流量大于阈值栅格,就是潜在的水流路径。
        * 河流分级
            + Strahler 河流分级方法
            + Shreve 河流分级方法
            + ![][sa-river-classify]
        * 流域的分割
            + 流域又称集水区域,指流经其中的水流和 / 或其它物质从一个公共的出水口排出从而形成了一个集中的排水区域。
            + 流域显示每个流域汇水区域的大小。
            + 出水口 ( 或出水点 ) 是流域内水流的出口,是整个流域的最低处。
            + 流域间的分界线是分水岭。
            + 分水岭包围的区域称为一条河流或水系的流域,
            + 流域分水线所包围的区域面积就是流域面积。
    #. 水淹分析:
        * 洪水淹没方式分为:
            + 漫堤式淹没: 分析在特定水位条件下,洪水会导致多大的淹没范围和多高的水深分布。
            + 决堤式淹没: 分析某一洪量条件下,洪水可能造成多大的淹没范围和水深分布。
        * 水淹分析是基于地形数据实现的。
            + TIN 数据: 由于其存储和分析的复杂性,不利于水淹分析。
            + GRID 数据: 水淹分析的主要数据源。
        * 给定洪水水位的淹没分析:
            + 首先确定洪水水源入口 ;
            + 再根据给定的洪水水位,从水源处开始进行格网连通性分析,所有能够与入口处连通的格网单元就是洪水淹没的范围。
            + 计算淹没范围内格网的水深 W,得到水深分布情况: W = H - E, (H: 洪水水位; E: 格网单元高程值)
        * 水流方向:由高向低沿着坡度最陡的方向流动,可以根据该点的 8 个相邻格网的高程来判断。
            + 具体算法:
            + 首先从水平、垂直四个方向的格网( 灰色部分 ) 高程中找出最大高程点 hmax1 和最小高程点 hmin1 ;
            + 从对角线的四个方向 ( 白色部分 ) 找出最大高程点 hmax2 和最小高程点 hmin2 ;
            + 对 hmax1 和 hmax2 进行比较: max((hmax1-h)/d, (hmax2-h)/(sqrt(2)*d)): d : DEM 格网间距 ; h : DEM 中当前点的高程。
            + 选出的点即当前点的上游点 ( 入水点 ) 。
    #. 径流分析:
        * 能够形成地表径流的地貌形态:河流及洪水形成的山谷沟渠。
        * 河流和山谷都属于谷地地貌,可以通过山谷线来判断,山谷线的生成与谷点分布相关。
        * 进行径流分析前要先找出该区域的谷脊点。
        * 通过谷脊分析得到谷点和脊点后,可根据山谷线的特征获取山谷线,从而得到地表径流路径。
    #. 叠置分析
    #. 阴影分析
    #. 可视性分析
    #. 缓冲区分析

ArcGIS 的三维数据空间分析工具

:   有不错的 GUI 界面，还有足够强大的 Python 接口，参见 [空间分析实习报告](post-0018-spatial-analysis.html)。

[sa-digital-terrian-model]: http://gnat.qiniudn.com/sa/sa-digital-terrian-model.png
[sa-dem-present]: http://gnat.qiniudn.com/sa/sa-dem-present.png
[sa-grid-tin-contour]: http://gnat.qiniudn.com/sa/sa-grid-tin-contour.png
[sa-contour-shade]: http://gnat.qiniudn.com/sa/sa-contour-shade.png
[sa-contour-shade2]: http://gnat.qiniudn.com/sa/sa-contour-shade2.png
[sa-3d-display]: http://gnat.qiniudn.com/sa/sa-3d-display.png
[sa-projection]: http://gnat.qiniudn.com/sa/sa-projection.png
[sa-volumn-tri]: http://gnat.qiniudn.com/sa/sa-volumn-tri.png
[sa-horn-s]: http://gnat.qiniudn.com/sa/sa-horn-s.png
[sa-horn-d]: http://gnat.qiniudn.com/sa/sa-horn-d.png
[sa-irregular-sd]: http://gnat.qiniudn.com/sa/sa-irregular-sd.png
[sa-filled-sink]: http://gnat.qiniudn.com/sa/sa-filled-sink.png
[sa-grid-encoding]: http://gnat.qiniudn.com/sa/sa-grid-encoding.png
[sa-river-length]: http://gnat.qiniudn.com/sa/sa-river-length.png
[sa-river-classify]: http://gnat.qiniudn.com/sa/sa-river-classify.png

### 3.6. 小结

空间分析是在空间认知基础上，对栅格或者矢量的地理空间数据所进行的定性和定量分析。

4. 总结
-------

地理信息系统在生产生活中应用广泛，作用巨大。应该积极利用各个学科，协助 GIS 的发展，
促进其进步。首先要利用哲学思想指导 GIS 的研究工作，其次要用数学知识提出合理的假设构建适用的模型，
最后通过编程的方式让计算机实现这个地理信息系统[^kunfu]。

[^kunfu]: 功夫在诗外，只有多借鉴学科中的理论与方法，融入地理信息系统的研究过程中，GIS 才能大步发展。

5. 参考文献
-----------

[wetland]: http://gnat.qiniudn.com/gishomwork/wetland.png
[6parts-of-gis]: http://gnat.qiniudn.com/gishomwork/6parts-of-gis3.png
[gis-research]: http://gnat.qiniudn.com/gishomwork/gis-research.png
[spatial-ref]: http://gnat.qiniudn.com/gishomwork/spatial-ref.png
[arch-of-cham]: http://gnat.qiniudn.com/gishomwork/arch-of-cham.png
[hyper-gami]: http://gnat.qiniudn.com/gishomwork/hyper-gami.png
[phonological]: http://gnat.qiniudn.com/gishomwork/phonological.png
[gis-paperwork-docx]: http://gnat.qiniudn.com/gishomwork/gis-paperwork.docx

---

Refs

#. 空间分析，Slides，武汉大学遥感信息工程学院
#. 我 2013 年笔记：[notes/空间分析.md at master · district10/notes](https://github.com/district10/notes/blob/master/2014/%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90.md)
